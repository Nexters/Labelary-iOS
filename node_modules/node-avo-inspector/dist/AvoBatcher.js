"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.AvoBatcher = void 0;
const AvoInspector_1 = require("./AvoInspector");
const AvoGuid_1 = require("./AvoGuid");
class AvoBatcher {
    constructor(networkCallsHandler) {
        this.networkCallsHandler = networkCallsHandler;
    }
    handleTrackSchema(eventName, schema, eventId, eventHash) {
        const seeionId = AvoGuid_1.AvoGuid.newGuid();
        return this.networkCallsHandler
            .callInspectorWithBatchBody([
            this.networkCallsHandler.bodyForSessionStartedCall(seeionId),
        ])
            .then(() => {
            if (AvoInspector_1.AvoInspector.shouldLog) {
                console.log("Avo Inspector: schema sent successfully.");
            }
            this.networkCallsHandler.callInspectorWithBatchBody([
                this.networkCallsHandler.bodyForEventSchemaCall(seeionId, eventName, schema, eventId, eventHash),
            ]);
        })
            .catch((err) => {
            if (AvoInspector_1.AvoInspector.shouldLog) {
                console.log("Avo Inspector: schema sending failed: " + err + ".");
            }
        });
    }
}
exports.AvoBatcher = AvoBatcher;
